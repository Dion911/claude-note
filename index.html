<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#F5F2ED" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Dione OS" />
  <meta name="description" content="Dione OS ‚Äì Field Notes Edition. A structured field journal system." />
  <link rel="manifest" href="./manifest.json" />
  <!-- GitHub Pages SPA redirect receiver (pairs with 404.html) -->
  <script>
    (function (l) {
      if (l.search[1] === '/') {
        var decoded = l.search.slice(1).split('&').map(function (s) {
          return s.replace(/~and~/g, '&');
        });
        window.history.replaceState(
          null, null,
          l.pathname.slice(0, -1) + decoded[0] +
          (decoded[1] ? '?' + decoded[1] : '') + l.hash
        );
      }
    }(window.location));
  </script>
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />
  <link rel="icon" type="image/png" href="./icons/icon-192.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="./styles.css" />
  <title>Dione OS ‚Äì Field Notes</title>
</head>
<body>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       APP SHELL
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="app">

    <!-- TOP BAR -->
    <header class="top-bar" id="top-bar">
      <div class="top-bar__inner">
        <div class="top-bar__brand">
          <span class="top-bar__logo">‚óà</span>
          <span class="top-bar__title" id="top-bar-title">Daily</span>
        </div>
        <div class="top-bar__actions">
          <button class="icon-btn" id="btn-export" aria-label="Export data" title="Export">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          </button>
          <button class="icon-btn" id="btn-import" aria-label="Import data" title="Import">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          </button>
        </div>
      </div>
    </header>

    <!-- MAIN CONTENT AREA -->
    <main class="main-content" id="main-content">

      <!-- ‚îÄ‚îÄ‚îÄ MODE 1: DAILY LOG ‚îÄ‚îÄ‚îÄ -->
      <section class="view" id="view-daily" data-view="daily">
        <div class="view__inner">
          <div class="daily-header">
            <div class="daily-date" id="daily-today-label"></div>
            <div class="mood-strip" id="mood-strip-daily">
              <button class="mood-btn" data-mood="great" aria-label="Great mood">üòÑ</button>
              <button class="mood-btn" data-mood="good" aria-label="Good mood">üôÇ</button>
              <button class="mood-btn" data-mood="okay" aria-label="Okay mood">üòê</button>
              <button class="mood-btn" data-mood="off" aria-label="Off mood">üòî</button>
              <button class="mood-btn" data-mood="bad" aria-label="Bad mood">üòû</button>
            </div>
          </div>
          <div class="timeline" id="timeline"></div>
        </div>
      </section>

      <!-- ‚îÄ‚îÄ‚îÄ MODE 2: PROJECTS ‚îÄ‚îÄ‚îÄ -->
      <section class="view hidden" id="view-projects" data-view="projects">
        <div class="view__inner">
          <!-- Project list -->
          <div id="projects-grid-view">
            <div class="section-label">Folders</div>
            <div class="projects-grid" id="projects-grid"></div>
            <button class="btn btn--ghost full-width" id="btn-new-project">+ New Folder</button>
          </div>
          <!-- Project detail (hidden until opened) -->
          <div id="project-detail-view" class="hidden">
            <button class="back-btn" id="btn-back-projects">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
              Folders
            </button>
            <div class="project-detail-header">
              <h2 class="project-detail-title" id="project-detail-title"></h2>
              <span class="project-detail-count" id="project-detail-count"></span>
            </div>
            <div class="entry-list" id="project-entry-list"></div>
          </div>
        </div>
      </section>

      <!-- ‚îÄ‚îÄ‚îÄ MODE 3: THINKING ‚îÄ‚îÄ‚îÄ -->
      <section class="view hidden" id="view-thinking" data-view="thinking">
        <div class="view__inner">
          <div id="thinking-list-view">
            <div class="section-label">Long-form</div>
            <div class="thinking-list" id="thinking-list"></div>
            <button class="btn btn--ghost full-width" id="btn-new-thinking">+ New Page</button>
          </div>
          <!-- Thinking editor -->
          <div id="thinking-editor-view" class="hidden">
            <button class="back-btn" id="btn-back-thinking">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
              Pages
            </button>
            <div class="thinking-editor">
              <input class="thinking-title-input" id="thinking-title-input" type="text" placeholder="Untitled" maxlength="100" />
              <div class="thinking-toolbar">
                <button class="toolbar-btn" data-action="h1" title="Heading 1">H1</button>
                <button class="toolbar-btn" data-action="h2" title="Heading 2">H2</button>
                <button class="toolbar-btn" data-action="bold" title="Bold">B</button>
                <button class="toolbar-btn" data-action="ul" title="List">‚â°</button>
                <button class="toolbar-btn" data-action="checkbox" title="Checkbox">‚òê</button>
                <span class="toolbar-sep"></span>
                <button class="toolbar-btn" data-action="focus" title="Focus mode" id="btn-focus-mode">‚äû</button>
              </div>
              <textarea class="thinking-body" id="thinking-body" placeholder="Start writing...&#10;&#10;Use # for H1, ## for H2, - for lists, [ ] for checkboxes"></textarea>
              <div class="thinking-preview" id="thinking-preview"></div>
              <div class="thinking-actions">
                <button class="btn btn--primary" id="btn-save-thinking">SAVE</button>
                <button class="btn btn--ghost" id="btn-star-thinking">STAR</button>
                <button class="btn btn--ghost" id="btn-pin-thinking">PIN</button>
                <button class="btn btn--danger" id="btn-delete-thinking">DELETE</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ‚îÄ‚îÄ‚îÄ MODE 4: SEARCH ‚îÄ‚îÄ‚îÄ -->
      <section class="view hidden" id="view-search" data-view="search">
        <div class="view__inner">
          <div class="search-box">
            <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            <input class="search-input" id="search-input" type="search" placeholder="Search all entries..." autocomplete="off" />
          </div>
          <div class="filter-row">
            <button class="filter-chip active" data-filter="all">All</button>
            <button class="filter-chip" data-filter="pinned">Pinned</button>
            <button class="filter-chip" data-filter="starred">Starred</button>
            <button class="filter-chip" data-filter="daily">Daily</button>
            <button class="filter-chip" data-filter="project">Project</button>
            <button class="filter-chip" data-filter="thinking">Thinking</button>
          </div>
          <div class="search-results" id="search-results">
            <div class="empty-state">
              <span class="empty-icon">‚óà</span>
              <p>Type to search your field notes</p>
            </div>
          </div>
        </div>
      </section>

    </main>

    <!-- BOTTOM NAV -->
    <nav class="bottom-nav" id="bottom-nav">
      <button class="nav-btn active" data-view="daily" aria-label="Daily log">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
        <span>Daily</span>
      </button>
      <button class="nav-btn" data-view="projects" aria-label="Projects">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
        <span>Projects</span>
      </button>
      <button class="nav-btn" data-view="thinking" aria-label="Thinking">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
        <span>Thinking</span>
      </button>
      <button class="nav-btn" data-view="search" aria-label="Search">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <span>Search</span>
      </button>
    </nav>

    <!-- FLOATING ACTION BUTTON -->
    <button class="fab" id="fab" aria-label="Quick capture">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
    </button>

  </div><!-- /#app -->

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       MODALS & SHEETS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

  <!-- QUICK CAPTURE SHEET -->
  <div class="sheet-overlay hidden" id="capture-overlay">
    <div class="bottom-sheet" id="capture-sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-header">
        <h3 class="sheet-title">Quick Capture</h3>
        <button class="icon-btn" id="btn-close-capture" aria-label="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="capture-types">
        <button class="capture-type-btn" data-type="idea">
          <span class="capture-icon">üí°</span>
          <span>Idea</span>
        </button>
        <button class="capture-type-btn" data-type="expense">
          <span class="capture-icon">üí∏</span>
          <span>Expense</span>
        </button>
        <button class="capture-type-btn" data-type="coffee">
          <span class="capture-icon">‚òï</span>
          <span>Coffee Recipe</span>
        </button>
        <button class="capture-type-btn" data-type="quote">
          <span class="capture-icon">‚ùù</span>
          <span>Quote</span>
        </button>
        <button class="capture-type-btn" data-type="reminder">
          <span class="capture-icon">‚è∞</span>
          <span>Reminder</span>
        </button>
        <button class="capture-type-btn" data-type="blank">
          <span class="capture-icon">‚óª</span>
          <span>Blank</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ENTRY EDITOR SHEET (Daily / Quick Capture) -->
  <div class="sheet-overlay hidden" id="entry-overlay">
    <div class="bottom-sheet tall-sheet" id="entry-sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-header">
        <h3 class="sheet-title" id="entry-sheet-title">New Entry</h3>
        <button class="icon-btn" id="btn-close-entry" aria-label="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="entry-form">
        <input type="hidden" id="entry-id" value="" />
        <input type="hidden" id="entry-mode" value="daily" />
        <input type="hidden" id="entry-project-id" value="" />
        <input type="hidden" id="entry-capture-type" value="" />

        <!-- Optional title -->
        <input class="entry-title-input" id="entry-title" type="text" placeholder="Title (optional)" maxlength="100" />

        <!-- Body -->
        <textarea class="entry-body-input" id="entry-body" placeholder="What's on your mind?" rows="5"></textarea>

        <!-- Mood (shown for daily/blank) -->
        <div class="form-group" id="mood-group">
          <label class="form-label">Mood</label>
          <div class="mood-selector" id="mood-selector">
            <button class="mood-btn" data-mood="great" aria-label="Great">üòÑ</button>
            <button class="mood-btn" data-mood="good" aria-label="Good">üôÇ</button>
            <button class="mood-btn" data-mood="okay" aria-label="Okay">üòê</button>
            <button class="mood-btn" data-mood="off" aria-label="Off">üòî</button>
            <button class="mood-btn" data-mood="bad" aria-label="Bad">üòû</button>
          </div>
        </div>

        <!-- Rating (shown for project entries) -->
        <div class="form-group hidden" id="rating-group">
          <label class="form-label">Rating</label>
          <div class="rating-selector" id="rating-selector">
            <button class="rating-btn" data-rating="great">Great</button>
            <button class="rating-btn" data-rating="good">Good</button>
            <button class="rating-btn" data-rating="okay">Okay</button>
            <button class="rating-btn" data-rating="off">Off</button>
            <button class="rating-btn" data-rating="bad">Bad</button>
          </div>
        </div>

        <!-- Tags -->
        <div class="form-group">
          <label class="form-label">Tags</label>
          <div class="tags-input-area">
            <div class="tags-chips" id="tags-chips"></div>
            <input class="tags-input" id="tags-input" type="text" placeholder="Add tag, press Enter" maxlength="30" />
          </div>
        </div>

        <!-- Quick metrics (daily) -->
        <div class="form-group" id="metrics-group">
          <label class="form-label">Quick Metrics</label>
          <div class="metrics-row">
            <div class="metric-item">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9z"/></svg>
              <span class="metric-label">Sleep</span>
              <input class="metric-input" id="metric-sleep" type="number" min="0" max="24" step="0.5" placeholder="hrs" />
            </div>
            <div class="metric-item">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>
              <span class="metric-label">Coffee</span>
              <input class="metric-input" id="metric-coffee" type="number" min="0" max="20" step="1" placeholder="cups" />
            </div>
          </div>
        </div>

        <!-- Attachment (project) -->
        <div class="form-group hidden" id="attachment-group">
          <label class="form-label">Attachments</label>
          <label class="attach-btn btn btn--ghost">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/></svg>
            ATTACH FILE
            <input type="file" id="attachment-input" accept="image/*" multiple class="visually-hidden" />
          </label>
          <div class="attachments-preview" id="attachments-preview"></div>
        </div>

        <!-- Actions -->
        <div class="entry-actions">
          <button class="btn btn--primary" id="btn-save-entry">SAVE</button>
          <button class="btn btn--ghost" id="btn-pin-entry">PIN</button>
          <button class="btn btn--ghost" id="btn-star-entry">STAR</button>
          <button class="btn btn--danger hidden" id="btn-delete-entry">DELETE</button>
        </div>
      </div>
    </div>
  </div>

  <!-- NEW PROJECT SHEET -->
  <div class="sheet-overlay hidden" id="project-overlay">
    <div class="bottom-sheet" id="project-sheet">
      <div class="sheet-handle"></div>
      <div class="sheet-header">
        <h3 class="sheet-title">New Folder</h3>
        <button class="icon-btn" id="btn-close-project" aria-label="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="entry-form">
        <input class="entry-title-input" id="project-name-input" type="text" placeholder="Folder name" maxlength="60" />
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="entry-body-input small" id="project-desc-input" placeholder="Optional description" rows="2"></textarea>
        </div>
        <div class="entry-actions">
          <button class="btn btn--primary" id="btn-save-project">CREATE</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast" aria-live="polite"></div>

  <!-- HIDDEN FILE INPUT FOR IMPORT -->
  <input type="file" id="import-file-input" accept=".json" class="visually-hidden" />

  <!-- FOCUS MODE OVERLAY -->
  <div class="focus-overlay hidden" id="focus-overlay">
    <button class="focus-exit-btn" id="btn-exit-focus">Exit Focus Mode</button>
    <textarea class="focus-textarea" id="focus-textarea" placeholder="Write freely..."></textarea>
    <div class="focus-word-count" id="focus-word-count">0 words</div>
  </div>

  <script src="./db.js"></script>
  <script src="./app.js"></script>
</body>
</html>
